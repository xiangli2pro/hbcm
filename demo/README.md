# Code for manuscript *Community Detection with Heterogeneous Block Covariance Model*


The folder provides comprehensive code scripts to replicate the numerical results and graphs presented in manuscript *Community Detection with Heterogeneous Block Covariance Model*. The readme doc gives instructions to navigate the files.


## Data

**Real Gene Expression Data**

The yeast gene expression data sets used in the manuscript Figure 3 and Figure 4 are embedded in the `hbcm` package, and can be directly called by their names (`data_gene_sample`, `data_gene_group`) in R (NO need to use the `load()` function). 

The data sets can also be downloaded from the [package github webpage](https://github.com/xiangli2pro/hbcm/tree/main/data). Those data sets are processed following the [script](https://github.com/xiangli2pro/hbcm/blob/main/data-raw/yeast_gene_data.R) here. Raw data pre-process is available in [package github webpage](https://github.com/xiangli2pro/hbcm/tree/main/inst/extdata).

**Simulation Data**

Simulation data can be generated by running the R scripts provided in this directory. Note that the manuscript used 100 simulation data sets for each scenario, which requires intensive computing resources and was executed on cloud computing platform. If the purpose is to test the code and have a simple demo, we recommend to use fewer (<5) simulation data for each scenario.

## Scripts

Each script has a markdown (`.qmd`) version and a pdf version (`.pdf`). Users can either download the markdown version and execute it as instructed, OR, check the code and output in the pdf version. 

**To replicate manuscript Table 1 simulation**
- Run `table1_simulation.qmd` or use `table1_simulation.pdf`

**To replicate manuscript Figure 1 simulation**
- Run `figure1_left_simulation.qmd` or use `figure1_left_simulation.pdf`;
- Run `figure1_middle_simulation.qmd` or use `figure1_middle_simulation.pdf`;
- Run `figure1_right_tdist_simulation.qmd` or use `figure1_right_tdist_simulation.pdf`;
- Run `figure1_right_tdist_corrected_simulation.qmd` or use `figure1_right_tdist_corrected_simulation.pdf`.

**To replicate manuscript Figure 2 simulation**
- Run `figure2_simulation.qmd` or use `figure2_simulation.pdf`.

**To replicate manuscript Figure 3 simulation**
- Run `figure3_plot.qmd` or use `figure3_plot.pdf`.

**To replicate manuscript Figure 4 result**
- Run `figure4_plot.qmd` or use `figure4_plot.pdf`.






